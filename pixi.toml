[workspace]
channels = [
    "https://conda.modular.com/max-nightly",
    "conda-forge",
    "https://conda.modular.com/max",
    "https://repo.prefix.dev/modular-community",
]
platforms = ["osx-arm64", "linux-64"]
preview = ["pixi-build"]
name = "NuMojo"
version = "0.7.0"
description = "NuMojo is a library for numerical computing written in Mojo ðŸ”¥"
authors = [
    "Shivasankar <shivasankar.ka@gmail.com>",
    "MadAlex1997 <>",
    "Yuhao Zhu (æœ±å®‡æµ©) <dr.yuhao.zhu@outlook.com>",
    "mmenendezg <>",
    "sandstromviktor <>",
    "durnwalder <>",
]
license = "Apache-2.0"
readme = "README.MD"

[package]
name = "numojo"
version = "0.7.0"

[package.build]
backend = {name = "pixi-build-mojo", version = "0.*", channels = [
    "https://prefix.dev/pixi-build-backends",
    "https://prefix.dev/conda-forge",
]}

[package.build.config.pkg]
name = "numojo"

[package.host-dependencies]
modular = ">=25.6.1,<26"

[package.build-dependencies]
modular = ">=25.6.1,<26"

[package.run-dependencies]
modular = ">=25.6.1,<26"

[tasks]
# compile the package and copy it to the tests folder
package = "pixi run mojo package numojo && cp numojo.mojopkg tests/"
p = "clear && pixi run package"

# format the package
format = "pixi run mojo format ./"

# to run individual test files
run-test = { cmd = "pixi run mojo run -I tests/ $TEST_FILE", env = { TEST_FILE = "" } }

# Test core category
test_core = """
pixi run package && \
pixi run mojo run -I tests/ tests/core/test_array_indexing_and_slicing.mojo && \
pixi run mojo run -I tests/ tests/core/test_array_methods.mojo && \
pixi run mojo run -I tests/ tests/core/test_bool_masks.mojo && \
pixi run mojo run -I tests/ tests/core/test_complexArray.mojo && \
pixi run mojo run -I tests/ tests/core/test_complexSIMD.mojo && \
pixi run mojo run -I tests/ tests/core/test_matrix.mojo && \
pixi run mojo run -I tests/ -D F_CONTIGUOUS tests/core/test_matrix.mojo && \
pixi run mojo run -I tests/ tests/core/test_shape_strides_item.mojo && \
rm tests/numojo.mojopkg
"""

# Test routines category
test_routines = """
pixi run package && \
pixi run mojo run -I tests/ tests/routines/test_creation.mojo && \
pixi run mojo run -I tests/ tests/routines/test_functional.mojo && \
pixi run mojo run -I tests/ tests/routines/test_indexing.mojo && \
pixi run mojo run -I tests/ tests/routines/test_io.mojo && \
pixi run mojo run -I tests/ tests/routines/test_linalg.mojo && \
pixi run mojo run -I tests/ tests/routines/test_manipulation.mojo && \
pixi run mojo run -I tests/ tests/routines/test_math.mojo && \
pixi run mojo run -I tests/ tests/routines/test_random.mojo && \
pixi run mojo run -I tests/ tests/routines/test_statistics.mojo && \
pixi run mojo run -I tests/ tests/routines/test_sorting.mojo && \
pixi run mojo run -I tests/ tests/routines/test_searching.mojo && \
rm tests/numojo.mojopkg
"""

# Test science category
test_signal = "pixi run package && pixi run mojo run -I tests/ tests/science/test_signal.mojo && rm tests/numojo.mojopkg"

test = """
pixi run test_core && \
pixi run test_routines && \
pixi run test_signal
"""

# run all final checks before a commit
final = "pixi run format && pixi run test"
f = "clear && pixi run final"

# Automatically Generate doc pages
doc_pages = "mojo doc numojo/ -o docs.json"

# run everything and generate docs before release
release = "clear && pixi run final && pixi run doc_pages"

[dependencies]
python = ">=3.14.0,<3.15"
numpy = ">=2.3.4,<3"
scipy = ">=1.16.3,<2"
modular = ">=26.1.0.dev2025111405,<27"
